<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SAC Demo - Project Architecture</title>
<style>
:root {
  --bg: #0f1117;
  --bg-card: #181a24;
  --bg-code: #0d0e14;
  --border: #2a2c3e;
  --text: #d8dae5;
  --text-dim: #7d8096;
  --accent: #6c5ce7;
  --accent2: #00cec9;
  --accent3: #fd79a8;
  --accent4: #ffeaa7;
  --green: #00b894;
  --mono: 'SF Mono', 'Cascadia Code', 'Fira Code', 'Consolas', monospace;
}

* { margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; }
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.7;
}

a { color: var(--accent2); text-decoration: none; }
a:hover { text-decoration: underline; }

/* Header */
header {
  border-bottom: 1px solid var(--border);
  padding: 2.5rem 2rem 2rem;
  max-width: 960px;
  margin: 0 auto;
}

header h1 {
  font-size: 2.4rem;
  font-weight: 800;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 0.4rem;
}

header p {
  color: var(--text-dim);
  font-size: 1.05rem;
  max-width: 640px;
}

/* TOC */
.toc {
  max-width: 960px;
  margin: 2rem auto;
  padding: 0 2rem;
}

.toc h2 {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 2px;
  color: var(--text-dim);
  margin-bottom: 0.8rem;
}

.toc ol {
  list-style: none;
  counter-reset: toc;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  gap: 0.4rem 1.5rem;
}

.toc li { counter-increment: toc; }

.toc li a {
  display: flex;
  align-items: center;
  gap: 0.6rem;
  padding: 0.4rem 0;
  color: var(--text);
  font-size: 0.92rem;
  transition: color 0.15s;
}

.toc li a::before {
  content: counter(toc);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 22px;
  height: 22px;
  border-radius: 6px;
  background: var(--accent);
  color: white;
  font-size: 0.7rem;
  font-weight: 700;
  flex-shrink: 0;
}

.toc li a:hover { color: var(--accent2); text-decoration: none; }

/* Sections */
.content {
  max-width: 960px;
  margin: 0 auto;
  padding: 1rem 2rem 4rem;
}

section {
  margin-top: 3rem;
  padding-top: 2rem;
  border-top: 1px solid var(--border);
}

section h2 {
  font-size: 1.6rem;
  font-weight: 700;
  margin-bottom: 0.3rem;
  color: var(--accent2);
}

section h3 {
  font-size: 1.1rem;
  font-weight: 600;
  margin: 1.5rem 0 0.5rem;
  color: var(--text);
}

section p, section li {
  color: var(--text-dim);
  font-size: 0.95rem;
}

section ul {
  padding-left: 1.3rem;
  margin: 0.5rem 0;
}

section li { margin: 0.3rem 0; }
section li strong { color: var(--text); }

/* Code references */
code {
  font-family: var(--mono);
  font-size: 0.83rem;
  background: var(--bg-code);
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 0.15rem 0.4rem;
  color: var(--accent4);
}

.code-block {
  background: var(--bg-code);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 1rem 1.3rem;
  font-family: var(--mono);
  font-size: 0.82rem;
  line-height: 1.65;
  overflow-x: auto;
  margin: 0.8rem 0;
  position: relative;
  color: var(--text-dim);
}

.code-block .tag {
  position: absolute;
  top: 0.5rem;
  right: 0.7rem;
  font-size: 0.6rem;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: var(--accent);
  font-family: sans-serif;
}

.line-ref {
  color: var(--accent3);
  font-family: var(--mono);
  font-size: 0.8rem;
  font-weight: 600;
}

/* Architecture diagram */
.arch-diagram {
  background: var(--bg-code);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 1.5rem;
  font-family: var(--mono);
  font-size: 0.78rem;
  line-height: 1.5;
  overflow-x: auto;
  white-space: pre;
  color: var(--text-dim);
  margin: 1rem 0;
}

.arch-diagram .h { color: var(--accent2); font-weight: 700; }
.arch-diagram .a { color: var(--accent); }
.arch-diagram .g { color: var(--green); }
.arch-diagram .p { color: var(--accent3); }
.arch-diagram .y { color: var(--accent4); }

/* Cards grid */
.cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  margin: 1rem 0;
}

.card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 1.2rem;
}

.card h4 {
  font-size: 0.9rem;
  margin-bottom: 0.3rem;
  color: var(--accent2);
}

.card p {
  font-size: 0.82rem;
  color: var(--text-dim);
}

.card .lines {
  font-family: var(--mono);
  font-size: 0.72rem;
  color: var(--accent3);
  margin-top: 0.4rem;
}

/* Stats bar */
.stats {
  display: flex;
  gap: 2rem;
  flex-wrap: wrap;
  margin: 1rem 0;
}

.stat {
  text-align: center;
}

.stat .num {
  font-size: 1.8rem;
  font-weight: 800;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.stat .label {
  font-size: 0.75rem;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* Flow diagram */
.flow {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  flex-wrap: wrap;
  margin: 1rem 0;
}

.flow-step {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 0.5rem 0.9rem;
  font-size: 0.82rem;
  color: var(--text);
}

.flow-arrow { color: var(--accent); font-size: 1.1rem; }

/* Footer */
footer {
  text-align: center;
  padding: 2rem;
  border-top: 1px solid var(--border);
  color: var(--text-dim);
  font-size: 0.8rem;
  max-width: 960px;
  margin: 0 auto;
}
</style>
</head>
<body>

<header>
  <h1>SAC Demo - Architecture</h1>
  <p>A self-contained, zero-dependency interactive web app that demonstrates the features of the SAC (Single-Assignment C) programming language through six interactive visualizations.</p>
</header>

<div class="toc">
  <h2>Contents</h2>
  <ol>
    <li><a href="#overview">Project Overview</a></li>
    <li><a href="#structure">File Structure &amp; Stats</a></li>
    <li><a href="#layout">High-Level Architecture</a></li>
    <li><a href="#css">CSS Design System</a></li>
    <li><a href="#html">HTML Sections</a></li>
    <li><a href="#js">JavaScript Modules</a></li>
    <li><a href="#mandelbrot">Mandelbrot Hero</a></li>
    <li><a href="#arrays">Array Operations</a></li>
    <li><a href="#tensors">Tensor Comprehensions</a></li>
    <li><a href="#stencil">Stencil Convolution</a></li>
    <li><a href="#parallel">Parallelization Benchmark</a></li>
    <li><a href="#nbody">N-Body Simulation</a></li>
  </ol>
</div>

<div class="content">

<!-- 1. Overview -->
<section id="overview">
  <h2>1. Project Overview</h2>
  <p>This project is an interactive demo website for <strong>SAC (Single-Assignment C)</strong>, a functional array programming language designed for high-performance computing. The demo lets users explore SAC's core concepts&mdash;shape-polymorphic arrays, tensor comprehensions, stencil operations, auto-parallelization, and N-body physics&mdash;through hands-on browser-based visualizations.</p>

  <h3>What is SAC?</h3>
  <ul>
    <li><strong>Functional + C syntax</strong> &mdash; immutable data semantics with familiar C-like code</li>
    <li><strong>Shape-polymorphic arrays</strong> &mdash; operations work on arrays of any rank and shape</li>
    <li><strong>Auto-parallelization</strong> &mdash; same source compiles to sequential, multi-threaded (pthreads), and CUDA GPU targets with no code changes</li>
    <li><strong>Compiler optimizations</strong> &mdash; fusion, tiling, vectorization handled automatically</li>
  </ul>

  <h3>Design Philosophy</h3>
  <ul>
    <li><strong>Zero dependencies</strong> &mdash; no build tools, no frameworks, no CDN imports</li>
    <li><strong>Single file</strong> &mdash; everything lives in one <code>index.html</code> for maximum portability</li>
    <li><strong>Pure browser APIs</strong> &mdash; Canvas 2D, DOM manipulation, requestAnimationFrame</li>
    <li><strong>Dark-themed</strong> &mdash; professional aesthetic with a purple/teal color palette</li>
  </ul>
</section>

<!-- 2. Structure -->
<section id="structure">
  <h2>2. File Structure &amp; Stats</h2>

  <div class="code-block">
    <span class="tag">tree</span>
sac-demo/
  index.html          # The entire application (1,759 lines)
  architecture.html   # This documentation file
  .git/               # Git repository</div>

  <div class="stats">
    <div class="stat">
      <div class="num">1</div>
      <div class="label">Source File</div>
    </div>
    <div class="stat">
      <div class="num">1,759</div>
      <div class="label">Total Lines</div>
    </div>
    <div class="stat">
      <div class="num">603</div>
      <div class="label">CSS Lines</div>
    </div>
    <div class="stat">
      <div class="num">265</div>
      <div class="label">HTML Lines</div>
    </div>
    <div class="stat">
      <div class="num">886</div>
      <div class="label">JS Lines</div>
    </div>
    <div class="stat">
      <div class="num">0</div>
      <div class="label">Dependencies</div>
    </div>
  </div>
</section>

<!-- 3. Architecture -->
<section id="layout">
  <h2>3. High-Level Architecture</h2>
  <p>The application is a monolithic single-page HTML file organized into three layers: a CSS design system, semantic HTML sections, and isolated JavaScript IIFE modules.</p>

  <div class="arch-diagram"><span class="h">index.html (1,759 lines)</span>
<span class="a">+---------------------------------------------------------------+</span>
<span class="a">|</span>  <span class="g">&lt;style&gt;</span>  CSS Design System                    <span class="y">Lines 7-603</span>    <span class="a">|</span>
<span class="a">|</span>    <span class="p">CSS Variables (theming)</span>                   <span class="y">Lines 8-24</span>     <span class="a">|</span>
<span class="a">|</span>    <span class="p">Component styles (nav, hero, cards...)</span>   <span class="y">Lines 26-602</span>   <span class="a">|</span>
<span class="a">+---------------------------------------------------------------+</span>
<span class="a">|</span>  <span class="g">&lt;body&gt;</span>   HTML Sections                        <span class="y">Lines 605-870</span>  <span class="a">|</span>
<span class="a">|</span>    <span class="p">Navigation bar</span>                           <span class="y">Lines 607-617</span>  <span class="a">|</span>
<span class="a">|</span>    <span class="p">Hero (Mandelbrot canvas)</span>                 <span class="y">Lines 620-636</span>  <span class="a">|</span>
<span class="a">|</span>    <span class="p">"What is SAC?" intro cards</span>               <span class="y">Lines 641-664</span>  <span class="a">|</span>
<span class="a">|</span>    <span class="p">Array Operations (interactive)</span>           <span class="y">Lines 669-701</span>  <span class="a">|</span>
<span class="a">|</span>    <span class="p">Tensor Comprehensions</span>                    <span class="y">Lines 706-743</span>  <span class="a">|</span>
<span class="a">|</span>    <span class="p">Stencil Convolution</span>                      <span class="y">Lines 748-781</span>  <span class="a">|</span>
<span class="a">|</span>    <span class="p">Parallelization Benchmark</span>                <span class="y">Lines 786-822</span>  <span class="a">|</span>
<span class="a">|</span>    <span class="p">N-Body Simulation</span>                        <span class="y">Lines 827-862</span>  <span class="a">|</span>
<span class="a">|</span>    <span class="p">Footer</span>                                   <span class="y">Lines 864-870</span>  <span class="a">|</span>
<span class="a">+---------------------------------------------------------------+</span>
<span class="a">|</span>  <span class="g">&lt;script&gt;</span> JavaScript Modules (IIFEs)          <span class="y">Lines 872-1757</span> <span class="a">|</span>
<span class="a">|</span>    <span class="p">Mandelbrot Hero renderer</span>                 <span class="y">Lines 876-1002</span> <span class="a">|</span>
<span class="a">|</span>    <span class="p">IntersectionObserver (fade-in)</span>           <span class="y">Lines 1007-1012</span><span class="a">|</span>
<span class="a">|</span>    <span class="p">Array Operations engine</span>                  <span class="y">Lines 1017-1150</span><span class="a">|</span>
<span class="a">|</span>    <span class="p">Tensor Comprehensions engine</span>             <span class="y">Lines 1155-1246</span><span class="a">|</span>
<span class="a">|</span>    <span class="p">Stencil Convolution engine</span>               <span class="y">Lines 1251-1369</span><span class="a">|</span>
<span class="a">|</span>    <span class="p">Parallelization Benchmark</span>                <span class="y">Lines 1374-1570</span><span class="a">|</span>
<span class="a">|</span>    <span class="p">N-Body Simulation</span>                        <span class="y">Lines 1575-1756</span><span class="a">|</span>
<span class="a">+---------------------------------------------------------------+</span></div>

  <h3>Module Isolation Pattern</h3>
  <p>Each interactive section is wrapped in an <strong>Immediately Invoked Function Expression (IIFE)</strong> to prevent variable leakage between modules. This is the only JavaScript scoping pattern used&mdash;no classes, no imports, no module system.</p>

  <div class="code-block">
    <span class="tag">pattern</span>
// Each section follows this pattern:
(function() {
  // 1. DOM element references
  const canvas = document.getElementById('...');

  // 2. State variables
  let state = { ... };

  // 3. Core computation functions
  function compute() { ... }

  // 4. Render/draw functions
  function render() { ... requestAnimationFrame(render); }

  // 5. Event listener setup
  document.querySelectorAll('.btn').forEach(btn => {
    btn.addEventListener('click', () => { ... });
  });

  // 6. Initialization
  init();
  render();
})();</div>
</section>

<!-- 4. CSS -->
<section id="css">
  <h2>4. CSS Design System</h2>
  <p>The visual design is built on CSS custom properties defined at <span class="line-ref">index.html:8-24</span>, providing a cohesive dark theme with accent colors.</p>

  <h3>Color Palette</h3>
  <div class="code-block">
    <span class="tag">index.html:8-24</span>
:root {
  --bg: #0a0a0f;          /* Deep dark background */
  --bg-card: #12121a;     /* Card surfaces */
  --border: #2a2a3a;      /* Subtle borders */
  --text: #e0e0e8;        /* Primary text */
  --text-dim: #8888a0;    /* Secondary text */
  --accent: #6c5ce7;      /* Purple - primary accent */
  --accent2: #00cec9;     /* Teal - secondary accent */
  --accent3: #fd79a8;     /* Pink - tertiary */
  --accent4: #ffeaa7;     /* Yellow - code numbers */
  --success: #00b894;     /* Green - strings/success */
}</div>

  <h3>Key CSS Patterns</h3>
  <ul>
    <li><strong>Backdrop blur nav</strong> <span class="line-ref">:48-62</span> &mdash; Fixed navigation with <code>backdrop-filter: blur(20px)</code> and semi-transparent background</li>
    <li><strong>Gradient text</strong> <span class="line-ref">:66-71</span> &mdash; Logo and headings use <code>background: linear-gradient</code> with <code>-webkit-background-clip: text</code></li>
    <li><strong>Responsive grids</strong> <span class="line-ref">:194-199</span> &mdash; <code>grid-template-columns: repeat(auto-fit, minmax(300px, 1fr))</code> for card layouts</li>
    <li><strong>Syntax highlighting classes</strong> <span class="line-ref">:253-258</span> &mdash; <code>.kw</code> (keyword), <code>.fn</code> (function), <code>.str</code> (string), <code>.num</code> (number), <code>.typ</code> (type), <code>.cmt</code> (comment)</li>
    <li><strong>Smooth animations</strong> <span class="line-ref">:582-594</span> &mdash; <code>fadeInUp</code> keyframes with staggered delays via <code>.delay-1</code> through <code>.delay-3</code></li>
  </ul>
</section>

<!-- 5. HTML -->
<section id="html">
  <h2>5. HTML Sections</h2>
  <p>The page is structured as a vertical scroll of seven content sections, each separated by gradient dividers (<span class="line-ref">:596-602</span>). Every section contains its interactive controls, visualization containers, and SAC code examples side by side.</p>

  <div class="cards">
    <div class="card">
      <h4>Navigation</h4>
      <p>Fixed top bar with blur backdrop. Anchor links to each section. Hides on mobile.</p>
      <div class="lines">Lines 607-617</div>
    </div>
    <div class="card">
      <h4>Hero / Mandelbrot</h4>
      <p>Full-viewport canvas with overlay text and SAC code sample. Click/scroll/drag interactive.</p>
      <div class="lines">Lines 620-636</div>
    </div>
    <div class="card">
      <h4>"What is SAC?"</h4>
      <p>Three info cards: Functional + Arrays, C Syntax, Auto-Parallelization.</p>
      <div class="lines">Lines 641-664</div>
    </div>
    <div class="card">
      <h4>Array Operations</h4>
      <p>Dimension selector (1D/2D/3D), operation buttons, animated grid, live SAC code display.</p>
      <div class="lines">Lines 669-701</div>
    </div>
    <div class="card">
      <h4>Tensor Comprehensions</h4>
      <p>Preset selector, with-loop code, input/output matrix visualization.</p>
      <div class="lines">Lines 706-743</div>
    </div>
    <div class="card">
      <h4>Stencil Convolution</h4>
      <p>Two canvases (original/filtered), kernel buttons, kernel grid display, SAC stencil code.</p>
      <div class="lines">Lines 748-781</div>
    </div>
    <div class="card">
      <h4>Parallelization</h4>
      <p>Thread progress bars, speedup chart canvas, compilation command examples.</p>
      <div class="lines">Lines 786-822</div>
    </div>
    <div class="card">
      <h4>N-Body Simulation</h4>
      <p>Particle canvas, sequential/parallel mode toggle, FPS stats, SAC all-pairs code.</p>
      <div class="lines">Lines 827-862</div>
    </div>
  </div>
</section>

<!-- 6. JS Modules -->
<section id="js">
  <h2>6. JavaScript Modules</h2>
  <p>All JavaScript lives in a single <code>&lt;script&gt;</code> block (<span class="line-ref">:872-1757</span>) containing seven isolated modules. Each uses only vanilla browser APIs&mdash;no libraries, no build step.</p>

  <h3>Rendering Technologies</h3>
  <ul>
    <li><strong>Canvas 2D API</strong> &mdash; used for Mandelbrot, stencil convolution, speedup chart, and N-body</li>
    <li><strong>DOM manipulation</strong> &mdash; used for array grids, tensor matrices, thread bars, and kernel displays</li>
    <li><strong>requestAnimationFrame</strong> &mdash; drives the Mandelbrot and N-body animation loops</li>
    <li><strong>IntersectionObserver</strong> &mdash; triggers fade-in animations on scroll</li>
  </ul>

  <h3>Data Flow per Module</h3>
  <div class="flow">
    <div class="flow-step">User clicks button</div>
    <span class="flow-arrow">&rarr;</span>
    <div class="flow-step">Event listener fires</div>
    <span class="flow-arrow">&rarr;</span>
    <div class="flow-step">State updated</div>
    <span class="flow-arrow">&rarr;</span>
    <div class="flow-step">Computation runs</div>
    <span class="flow-arrow">&rarr;</span>
    <div class="flow-step">DOM/Canvas re-rendered</div>
    <span class="flow-arrow">&rarr;</span>
    <div class="flow-step">SAC code block updated</div>
  </div>
</section>

<!-- 7. Mandelbrot -->
<section id="mandelbrot">
  <h2>7. Mandelbrot Hero</h2>
  <p><span class="line-ref">index.html:876-1002</span> &mdash; The hero section renders a continuously zooming Mandelbrot fractal on a full-viewport canvas, demonstrating what SAC can express in just 5 lines of code.</p>

  <h3>Key Implementation Details</h3>
  <ul>
    <li><strong>Resolution scaling</strong> <span class="line-ref">:889-895</span> &mdash; Renders at half device pixel ratio for performance (<code>Math.floor(W * dpr / 2)</code>)</li>
    <li><strong>Pixel-by-pixel iteration</strong> <span class="line-ref">:927-950</span> &mdash; Standard escape-time algorithm with <code>maxIter = 120</code></li>
    <li><strong>Smooth coloring</strong> <span class="line-ref">:942-944</span> &mdash; Continuous coloring via <code>iter + 1 - log2(log2(x*x + y*y))</code>, mapped to HSL with time-based hue cycling</li>
    <li><strong>Auto-zoom</strong> <span class="line-ref">:957</span> &mdash; <code>targetZoom *= 1.001</code> creates a gentle continuous zoom toward a visually interesting coordinate</li>
    <li><strong>Interactivity</strong> <span class="line-ref">:963-997</span> &mdash; Click to pause/resume, scroll wheel to zoom, mouse drag to pan</li>
  </ul>

  <div class="code-block">
    <span class="tag">index.html:882-886</span>
// Deep zoom target - a visually interesting Mandelbrot coordinate
let centerX = -0.7436447860, centerY = 0.1318252536;
let zoom = 0.8;
let targetZoom = 0.8;
let panX = 0, panY = 0;</div>

  <h3>Rendering Pipeline</h3>
  <div class="flow">
    <div class="flow-step">animate()</div>
    <span class="flow-arrow">&rarr;</span>
    <div class="flow-step">Advance time + zoom</div>
    <span class="flow-arrow">&rarr;</span>
    <div class="flow-step">render() per-pixel</div>
    <span class="flow-arrow">&rarr;</span>
    <div class="flow-step">putImageData()</div>
    <span class="flow-arrow">&rarr;</span>
    <div class="flow-step">requestAnimationFrame</div>
  </div>
</section>

<!-- 8. Arrays -->
<section id="arrays">
  <h2>8. Array Operations</h2>
  <p><span class="line-ref">index.html:1017-1150</span> &mdash; An interactive module that demonstrates SAC's rank-polymorphic array operations. Users can switch between 1D, 2D, and 3D arrays and apply operations like transpose, reverse, rotate, take, and drop.</p>

  <h3>State Management</h3>
  <div class="code-block">
    <span class="tag">index.html:1020-1021</span>
let currentDim = 2;    // Tracks which dimensionality is selected (1, 2, or 3)
let matrix;            // Current array state: { shape: [...], data: [...] }</div>

  <h3>Array Representation</h3>
  <p>Arrays are stored as flat objects with a <code>shape</code> array and a flat <code>data</code> array, mirroring how SAC internally represents multi-dimensional arrays:</p>
  <div class="code-block">
    <span class="tag">index.html:1030-1033</span>
// Factory function creates arrays of different ranks
if (dim === 1) return { shape: [8], data: [1,2,3,4,5,6,7,8] };
if (dim === 2) return { shape: [4,4], data: [1,2,...,16] };
return { shape: [2,3,3], data: Array.from({length:18}, (_,i) => i+1) };</div>

  <h3>Operations</h3>
  <ul>
    <li><strong>transpose()</strong> <span class="line-ref">:1057-1063</span> &mdash; Swaps row/column indices</li>
    <li><strong>reverse()</strong> <span class="line-ref">:1065-1071</span> &mdash; Reverses along first axis</li>
    <li><strong>rotate()</strong> <span class="line-ref">:1073-1087</span> &mdash; Circular shift along axis 1</li>
    <li><strong>take()</strong> <span class="line-ref">:1089-1096</span> &mdash; Selects first N elements per axis</li>
    <li><strong>drop()</strong> <span class="line-ref">:1098-1104</span> &mdash; Removes first element per axis</li>
  </ul>

  <h3>Visual Rendering</h3>
  <p>Each array cell is rendered as a colored <code>&lt;div&gt;</code> in a CSS grid (<span class="line-ref">:1035-1055</span>). Colors are assigned by value from a 16-color palette (<span class="line-ref">:1023-1027</span>), and cells fade in with staggered animation delays.</p>
</section>

<!-- 9. Tensors -->
<section id="tensors">
  <h2>9. Tensor Comprehensions</h2>
  <p><span class="line-ref">index.html:1155-1246</span> &mdash; Demonstrates SAC's with-loop syntax by showing five preset tensor operations on a 4&times;4 input matrix, with live input&rarr;output visualization.</p>

  <h3>Preset Operations</h3>
  <div class="code-block">
    <span class="tag">index.html:1160-1181</span>
// Each preset has a SAC code string and a JS transform function
const presets = {
  transpose: { code: '...', fn: (m) => m[0].map((_, j) => m.map(row => row[j])) },
  diagonal:  { code: '...', fn: (m) => [m.map((row, i) => row[i])] },
  rowsum:    { code: '...', fn: (m) => [m.map(row => row.reduce((a,b) => a+b, 0))] },
  scale:     { code: '...', fn: (m) => m.map(row => row.map(v => v * 2)) },
  upper:     { code: '...', fn: (m) => m.map((row,i) => row.map((v,j) => j>=i ? v : 0)) }
};</div>

  <p>The visualization (<span class="line-ref">:1183-1207</span>) renders two matrices side-by-side with an arrow between them. Cell background opacity scales with value intensity (<code>Math.abs(v) / 20</code>), and zero-valued cells in the result are dimmed.</p>
</section>

<!-- 10. Stencil -->
<section id="stencil">
  <h2>10. Stencil Convolution</h2>
  <p><span class="line-ref">index.html:1251-1369</span> &mdash; Applies 3&times;3 convolution kernels to a procedurally generated image, demonstrating how SAC expresses stencil operations.</p>

  <h3>Image Generation</h3>
  <p>The source image is procedurally generated at <span class="line-ref">:1262-1298</span> using overlapping geometric shapes (circles, rectangles, checkerboard) on a sinusoidal gradient background. No external images are loaded.</p>

  <h3>Available Kernels</h3>
  <div class="code-block">
    <span class="tag">index.html:1302-1308</span>
const kernels = {
  identity: { k: [[0,0,0],[0,1,0],[0,0,0]], div: 1 },
  blur:     { k: [[1,2,1],[2,4,2],[1,2,1]], div: 16 },  // Gaussian
  sharpen:  { k: [[0,-1,0],[-1,5,-1],[0,-1,0]], div: 1 },
  edge:     { k: [[-1,-1,-1],[-1,8,-1],[-1,-1,-1]], div: 1 },  // Laplacian
  emboss:   { k: [[-2,-1,0],[-1,1,1],[0,1,2]], div: 1 }
};</div>

  <h3>Convolution Implementation</h3>
  <p>The <code>applyKernel()</code> function (<span class="line-ref">:1318-1357</span>) iterates over every pixel (skipping the 1px border), applies the 3&times;3 kernel with nested loops over <code>dx, dy</code> offsets, divides by the kernel divisor, and clamps to [0, 255]. This mirrors how SAC's stencil with-loops work.</p>
</section>

<!-- 11. Parallel -->
<section id="parallel">
  <h2>11. Parallelization Benchmark</h2>
  <p><span class="line-ref">index.html:1374-1570</span> &mdash; Simulates multi-threaded execution by chunking a Mandelbrot computation across 1, 2, 4, and 8 "threads" (using <code>setTimeout</code>-based cooperative multitasking), then charts the speedup.</p>

  <h3>Benchmark Approach</h3>
  <div class="code-block">
    <span class="tag">index.html:1507-1556</span>
// For each thread count (1, 2, 4, 8):
//   1. Divide 300 rows into tc chunks
//   2. Each "thread" processes its chunk in 20 sub-chunks
//   3. Sub-chunks yield via setTimeout(doChunk, 0) to update the UI
//   4. Promise.all() waits for all threads to complete
//   5. Wall-clock time is recorded and speedup calculated</div>

  <h3>Visualization Components</h3>
  <ul>
    <li><strong>Progress bars</strong> <span class="line-ref">:1386-1401</span> &mdash; Four horizontal bars with color-coded fills, updated as each sub-chunk completes</li>
    <li><strong>Speedup chart</strong> <span class="line-ref">:1403-1484</span> &mdash; Canvas-rendered line chart comparing actual speedup vs. ideal linear scaling. Includes axis labels, grid lines, data points, and a dashed "ideal" reference line</li>
  </ul>

  <p>Note: Because JavaScript is single-threaded, the "parallel" execution is simulated. The demo illustrates the concept of SAC's auto-parallelization rather than achieving true parallel speedup.</p>
</section>

<!-- 12. N-Body -->
<section id="nbody">
  <h2>12. N-Body Simulation</h2>
  <p><span class="line-ref">index.html:1575-1756</span> &mdash; A 200-particle gravitational simulation rendered on a canvas, demonstrating SAC's ability to express all-pairs computations concisely.</p>

  <h3>Physics Constants</h3>
  <div class="code-block">
    <span class="tag">index.html:1579-1582</span>
const N = 200;           // Number of particles
const G = 0.5;           // Gravitational constant
const DT = 0.016;        // Time step (~60 FPS)
const SOFTENING = 4.0;   // Prevents division by zero at close range</div>

  <h3>Particle Initialization</h3>
  <p>Particles are spawned in a ring formation (<span class="line-ref">:1590-1606</span>) with random radii (80-200px from center), tangential velocities for orbital motion, random masses (0.5-3.0), and hue values based on angular position for a rainbow ring effect.</p>

  <h3>Physics Step</h3>
  <p>The <code>step()</code> function (<span class="line-ref">:1608-1647</span>) implements an O(N&sup2;) all-pairs gravity calculation:</p>
  <div class="code-block">
    <span class="tag">index.html:1613-1625</span>
// All-pairs acceleration (mirrors SAC's with-loop)
for (let i = 0; i &lt; N; i++) {
  for (let j = 0; j &lt; N; j++) {
    if (i === j) continue;
    const dx = particles[j].x - particles[i].x;
    const dy = particles[j].y - particles[i].y;
    const distSq = dx*dx + dy*dy + SOFTENING;
    const dist = Math.sqrt(distSq);
    const force = G * particles[j].mass / (distSq * dist);
    ax[i] += dx * force;
    ay[i] += dy * force;
  }
}</div>

  <p>Integration uses Euler method with 0.1% velocity damping (<span class="line-ref">:1631</span>) to prevent energy explosion. A soft boundary at radius 280px reflects particles inward (<span class="line-ref">:1637-1645</span>).</p>

  <h3>Sequential vs. Parallel Visualization</h3>
  <ul>
    <li><strong>Parallel mode</strong> <span class="line-ref">:1671-1700</span> &mdash; All particles rendered with equal brightness and glow. Represents SAC's auto-parallelized output where all force calculations happen simultaneously.</li>
    <li><strong>Sequential mode</strong> <span class="line-ref">:1667-1714</span> &mdash; A "highlight cursor" sweeps through particles one at a time (<code>seqHighlight = (seqHighlight + 1) % N</code>). Only particles near the cursor are bright; lines are drawn from the highlighted particle to all others to show the force computation for that iteration.</li>
  </ul>

  <h3>Rendering</h3>
  <p>Each particle is drawn as two layers (<span class="line-ref">:1686-1699</span>): a radial gradient "glow" and a solid "core" circle. The trail effect comes from clearing the canvas with a semi-transparent fill (<code>rgba(5, 5, 8, 0.3)</code>) instead of a full clear (<span class="line-ref">:1662</span>).</p>
</section>

</div>

<footer>
  <p>Generated documentation for <a href="index.html">SAC Interactive Demo</a> &middot; All line references point to <code>index.html</code></p>
</footer>

</body>
</html>
